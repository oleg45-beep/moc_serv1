<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MOC - Secure Cloud</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>

    <!-- MODAL: AUTH -->
    <div id="auth-modal" class="modal">
        <div class="modal-card">
            <div class="modal-header">
                <i data-lucide="cloud" style="color:#a78bfa"></i> MOC
            </div>
            <h2 id="modal-title">–í—Ö–æ–¥</h2>
            <input type="text" id="auth-user" placeholder="–õ–æ–≥–∏–Ω">
            <input type="password" id="auth-pass" placeholder="–ü–∞—Ä–æ–ª—å">
            <button class="btn-primary" onclick="auth()">–í–æ–π—Ç–∏</button>
            <p class="link" onclick="toggleAuth()">–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞?</p>
            <p id="auth-err" class="error"></p>
        </div>
    </div>

    <!-- MODAL: AI CHAT -->
    <div id="ai-modal" class="modal hidden">
        <div class="modal-card chat-modal">
            <div class="modal-header-row">
                <h3><i data-lucide="bot"></i> MOC.AI</h3>
                <i data-lucide="x" class="close-icon" onclick="toggleModal('ai-modal')"></i>
            </div>
            <div id="ai-messages" class="mini-chat-area">
                <div class="msg ai">
                    <div class="msg-header">
                        <i data-lucide="bot" width="16" height="16"></i>
                        <strong>MOC.AI:</strong>
                    </div>
                    <div class="msg-text">–ü—Ä–∏–≤–µ—Ç! –Ø –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç MOC. –°–ø—Ä–æ—Å–∏ –º–µ–Ω—è –æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–∏, –∞–ª—å–±–æ–º–∞—Ö, –¥—Ä—É–∑—å—è—Ö –∏–ª–∏ –¥—Ä—É–≥–∏—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö –Ω–∞—à–µ–≥–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –æ–±–ª–∞–∫–∞!</div>
                </div>
                <div id="ai-suggestions" class="ai-suggestions">
                    <button class="ai-suggestion" onclick="insertAiSuggestion('–†–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ')">
                        –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
                    </button>
                    <button class="ai-suggestion" onclick="insertAiSuggestion('–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å –∞–ª—å–±–æ–º?')">
                        –ê–ª—å–±–æ–º—ã
                    </button>
                    <button class="ai-suggestion" onclick="insertAiSuggestion('–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∞?')">
                        –î—Ä—É–∑—å—è
                    </button>
                    <button class="ai-suggestion" onclick="insertAiSuggestion('–ß—Ç–æ —Ç–∞–∫–æ–µ —É–º–Ω—ã–µ –∞–ª—å–±–æ–º—ã?')">
                        –£–º–Ω—ã–µ –∞–ª—å–±–æ–º—ã
                    </button>
                    <button class="ai-suggestion" onclick="insertAiSuggestion('–ö–∞–∫ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–∞–π–ª –≤ —á–∞—Ç?')">
                        –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–æ–≤
                    </button>
                </div>
            </div>
            <div class="mini-input">
                <input type="text" id="ai-input" placeholder="–°–ø—Ä–æ—Å–∏ –æ MOC... (Enter –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏)">
                <button onclick="sendAi()"><i data-lucide="send"></i></button>
            </div>
        </div>
    </div>

    <!-- MODAL: BUG REPORT -->
    <div id="bug-modal" class="modal hidden">
        <div class="modal-card">
            <div class="modal-header-row">
                <h3><i data-lucide="alert-triangle" style="color: #fbbf24"></i> –°–æ–æ–±—â–∏—Ç—å –æ–± –æ—à–∏–±–∫–µ</h3>
                <i data-lucide="x" class="close-icon" onclick="toggleModal('bug-modal')"></i>
            </div>
            <p style="font-size:13px; color:#ccc; margin-bottom:10px;">–û–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É, –º—ã –≤—Å—ë –∏—Å–ø—Ä–∞–≤–∏–º.</p>
            <textarea id="bug-text" rows="4" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ù–µ –≥—Ä—É–∑—è—Ç—Å—è —Ñ–æ—Ç–æ..."></textarea>
            <button class="btn-primary" onclick="sendBug()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </div>
    </div>

    <!-- MODAL: CREATE ALBUM -->
    <div id="album-modal" class="modal hidden">
        <div class="modal-card">
            <div class="modal-header-row">
                <h3><i data-lucide="folder-plus"></i> –ù–æ–≤—ã–π –∞–ª—å–±–æ–º</h3>
                <i data-lucide="x" onclick="toggleModal('album-modal')"></i>
            </div>
            <input type="text" id="album-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä: –õ–µ—Ç–æ 2024)">
            <button class="btn-primary" onclick="createAlbum()">
                <i data-lucide="check"></i> –°–æ–∑–¥–∞—Ç—å
            </button>
        </div>
    </div>

    <!-- MODAL: EDIT PROFILE -->
    <div id="edit-profile-modal" class="modal hidden">
        <div class="modal-card">
            <div class="modal-header-row">
                <h3><i data-lucide="user"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</h3>
                <i data-lucide="x" onclick="toggleModal('edit-profile-modal')"></i>
            </div>
            <input type="text" id="edit-handle" placeholder="–û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è (@handle)">
            <textarea id="edit-bio" rows="3" placeholder="–û —Å–µ–±–µ"></textarea>
            <button class="btn-primary" onclick="saveProfile()">
                <i data-lucide="save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
            </button>
        </div>
    </div>

    <!-- MODAL: IMAGE VIEW -->
    <div id="image-modal" class="modal hidden">
        <div class="modal-card image-modal">
            <div class="modal-header-row">
                <h3><i data-lucide="image"></i> –ü—Ä–æ—Å–º–æ—Ç—Ä —Ñ–æ—Ç–æ</h3>
                <i data-lucide="x" class="close-icon" onclick="toggleModal('image-modal')"></i>
            </div>
            <div id="image-container">
                <img id="modal-image" src="" alt="" style="width:100%; border-radius:8px;">
            </div>
            <div class="image-actions">
                <button class="btn-secondary" onclick="downloadImage()">
                    <i data-lucide="download"></i> –°–∫–∞—á–∞—Ç—å
                </button>
                <button class="btn-primary" onclick="toggleModal('image-modal')">
                    <i data-lucide="x"></i> –ó–∞–∫—Ä—ã—Ç—å
                </button>
            </div>
        </div>
    </div>

    <!-- MODAL: ALBUM VIEW -->
    <div id="album-view-modal" class="modal hidden">
        <!-- –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
    </div>

    <!-- MODAL: ADD TO ALBUM -->
    <div id="add-to-album-modal" class="modal hidden">
        <div class="modal-card">
            <div class="modal-header-row">
                <h3><i data-lucide="folder-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –≤ –∞–ª—å–±–æ–º</h3>
                <i data-lucide="x" class="close-icon" onclick="toggleModal('add-to-album-modal')"></i>
            </div>
            <div id="albums-select">
                <p>–ó–∞–≥—Ä—É–∑–∫–∞ –∞–ª—å–±–æ–º–æ–≤...</p>
            </div>
            <div id="album-actions" class="hidden">
                <button class="btn-primary" onclick="addSelectedToAlbum()">
                    <i data-lucide="plus"></i> –î–æ–±–∞–≤–∏—Ç—å
                </button>
            </div>
        </div>
    </div>

    <!-- MODAL: SELECT FILES FOR ALBUM -->
    <div id="select-files-modal" class="modal hidden">
        <div class="modal-card">
            <div class="modal-header-row">
                <h3><i data-lucide="image"></i> –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ç–æ –¥–ª—è –∞–ª—å–±–æ–º–∞</h3>
                <i data-lucide="x" class="close-icon" onclick="toggleModal('select-files-modal')"></i>
            </div>
            <div id="files-select">
                <p>–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ...</p>
            </div>
            <div id="files-actions" class="hidden">
                <button class="btn-primary" onclick="addSelectedFilesToAlbum()">
                    <i data-lucide="plus"></i> –î–æ–±–∞–≤–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ
                </button>
            </div>
        </div>
    </div>

    <!-- MODAL: SHARE FILE -->
    <div id="share-file-modal" class="modal hidden">
        <div class="modal-card">
            <div class="modal-header-row">
                <h3><i data-lucide="share-2"></i> –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Ñ–∞–π–ª–æ–º</h3>
                <i data-lucide="x" class="close-icon" onclick="toggleModal('share-file-modal')"></i>
            </div>
            <div id="share-file-info">
                <p>–ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ–∞–π–ª–µ...</p>
            </div>
            <div class="share-options">
                <div class="share-option">
                    <h4><i data-lucide="link"></i> –°–æ–∑–¥–∞—Ç—å —Å—Å—ã–ª–∫—É</h4>
                    <p>–°–æ–∑–¥–∞–π—Ç–µ –ø—É–±–ª–∏—á–Ω—É—é —Å—Å—ã–ª–∫—É –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞</p>
                    <select id="share-expires">
                        <option value="1">–ù–∞ 1 —á–∞—Å</option>
                        <option value="24" selected>–ù–∞ 24 —á–∞—Å–∞</option>
                        <option value="168">–ù–∞ 7 –¥–Ω–µ–π</option>
                        <option value="720">–ù–∞ 30 –¥–Ω–µ–π</option>
                    </select>
                    <button class="btn-primary" onclick="createShareLink()">
                        <i data-lucide="link"></i> –°–æ–∑–¥–∞—Ç—å —Å—Å—ã–ª–∫—É
                    </button>
                </div>
                
                <div class="share-option">
                    <h4><i data-lucide="message-square"></i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ —á–∞—Ç</h4>
                    <p>–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–∞–π–ª –≤ –æ–¥–∏–Ω –∏–∑ –≤–∞—à–∏—Ö —á–∞—Ç–æ–≤</p>
                    <select id="share-chat-select">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —á–∞—Ç...</option>
                    </select>
                    <button class="btn-primary" onclick="sendFileToChat()">
                        <i data-lucide="send"></i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å
                    </button>
                </div>
            </div>
            
            <div id="share-result" class="hidden">
                <div class="share-success">
                    <i data-lucide="check-circle" style="color: #10B981;"></i>
                    <h4>–°—Å—ã–ª–∫–∞ —Å–æ–∑–¥–∞–Ω–∞!</h4>
                    <div class="share-link-container">
                        <input type="text" id="share-link" readonly>
                        <button class="btn-xs" onclick="copyShareLink()">
                            <i data-lucide="copy"></i>
                        </button>
                    </div>
                    <p class="share-note">–°—Å—ã–ª–∫–∞ –±—É–¥–µ—Ç –∞–∫—Ç–∏–≤–Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è</p>
                </div>
            </div>
        </div>
    </div>

    <!-- MAIN APP -->
    <div id="app" class="hidden">
        <aside class="sidebar">
            <div class="logo">
                <i data-lucide="cloud"></i> <span>MOC</span>
            </div>
            <nav>
                <a href="#" id="l-home" class="active" onclick="nav('home')">
                    <i data-lucide="home"></i> –ì–ª–∞–≤–Ω–∞—è
                </a>
                <a href="#" id="l-media" onclick="nav('media')">
                    <i data-lucide="image"></i> –ú–µ–¥–∏–∞
                </a>
                <a href="#" id="l-chats" onclick="nav('chats')">
                    <i data-lucide="message-square"></i> –ß–∞—Ç—ã
                </a>
                <a href="#" id="l-profile" onclick="nav('profile')">
                    <i data-lucide="user"></i> –ü—Ä–æ—Ñ–∏–ª—å
                </a>
                <a href="#" id="l-security" onclick="openSecurityDashboard()">
                    <i data-lucide="shield"></i> –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
                </a>
            </nav>
            <div class="user-mini">
                <div class="avatar-xs" id="mini-avatar">?</div>
                <div class="user-info">
                    <span id="mini-name">User</span>
                    <span onclick="logout()" class="logout-link">–í—ã–π—Ç–∏</span>
                </div>
            </div>
        </aside>

        <main class="content">
            <!-- VIEW: HOME -->
            <section id="v-home">
                <div class="hero">
                    <h1>MOC <span class="badge">SECURE</span></h1>
                    <p>–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ. –£–º–Ω–æ–µ. <span class="highlight">–¢–≤–æ—ë. üîê</span></p>
                </div>
                <div class="cards-grid">
                    <div class="card clickable" onclick="openSecurityDashboard()">
                        <i data-lucide="lock"></i>
                        <h3>–ü–æ–ª–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ</h3>
                        <p>XChaCha20-Poly1305 + AES-GCM-SIV</p>
                        <div class="encryption-badge">Client-first</div>
                    </div>
                    <div class="card clickable" onclick="toggleModal('ai-modal')">
                        <i data-lucide="bot"></i>
                        <h3>AI –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç</h3>
                        <p>–£–º–Ω—ã–π –ø–æ–∏—Å–∫ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞.</p>
                        <div class="encryption-badge">Edge AI</div>
                    </div>
                    <div class="card clickable" onclick="nav('chats')">
                        <i data-lucide="shield"></i>
                        <h3>–ü—Ä–∏–≤–∞—Ç–Ω—ã–µ —á–∞—Ç—ã</h3>
                        <p>E2EE + Proxy Re-Encryption</p>
                        <div class="encryption-badge">–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —à–∞—Ä–∏–Ω–≥</div>
                    </div>
                    <div class="card clickable" onclick="nav('media')">
                        <i data-lucide="layers"></i>
                        <h3>–£–º–Ω—ã–µ –∞–ª—å–±–æ–º—ã</h3>
                        <p>AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è + Adaptive Copies</p>
                        <div class="encryption-badge">ATC</div>
                    </div>
                    <div class="card clickable" onclick="setupSocialRecovery()">
                        <i data-lucide="users"></i>
                        <h3>Social Recovery</h3>
                        <p>–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –¥—Ä—É–∑–µ–π</p>
                        <div class="encryption-badge">Shamir SS</div>
                    </div>
                    <div class="card clickable" onclick="document.getElementById('file-in').click()">
                        <i data-lucide="upload"></i>
                        <h3>–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞</h3>
                        <p>–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ</p>
                        <div class="encryption-badge">Zero-knowledge</div>
                    </div>
                </div>
                
                <!-- –°—Ç–∞—Ç—É—Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è -->
                <div id="home-encryption-status" style="margin-top: 40px; padding: 25px; background: white; border-radius: var(--radius); box-shadow: var(--shadow);">
                    <h3 style="display: flex; align-items: center; gap: 10px; margin-bottom: 20px;">
                        <i data-lucide="shield"></i> –°—Ç–∞—Ç—É—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
                    </h3>
                    <div id="home-encryption-info">
                        <div style="text-align: center; padding: 20px; color: var(--text-secondary);">
                            <i data-lucide="loader" width="24" height="24" style="animation: spin 1s linear infinite;"></i>
                            <p style="margin-top: 10px;">–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è...</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- VIEW: MEDIA -->
            <section id="v-media" class="hidden">
                <div class="top-bar">
                    <h2><i data-lucide="image"></i> –ú–µ–¥–∏–∞—Ç–µ–∫–∞</h2>
                    <div class="controls">
                        <button class="btn-sec" onclick="loadContent()" title="–û–±–Ω–æ–≤–∏—Ç—å">
                            <i data-lucide="refresh-cw"></i> –û–±–Ω–æ–≤–∏—Ç—å
                        </button>
                        <button class="btn-sec" onclick="toggleModal('album-modal')" title="–°–æ–∑–¥–∞—Ç—å –∞–ª—å–±–æ–º">
                            <i data-lucide="folder-plus"></i> –ê–ª—å–±–æ–º
                        </button>
                        <button class="btn-pri" onclick="document.getElementById('file-in').click()" title="–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ">
                            <i data-lucide="upload"></i> –ó–∞–≥—Ä—É–∑–∏—Ç—å
                        </button>
                        <!-- –î–û–ë–ê–í–¨–¢–ï –≠–¢–£ –ö–ù–û–ü–ö–£ -->
                        <button class="btn-pri" onclick="uploadEncryptedFile()" title="–ó–∞–≥—Ä—É–∑–∏—Ç—å —Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º" style="background: linear-gradient(135deg, #8B5CF6, #EC4899);">
                            <i data-lucide="lock"></i> –ó–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª
                        </button>
                        <input type="file" id="file-in" hidden accept="image/*,video/*">
                    </div>
                </div>
                
                <h3 class="sec-title"><i data-lucide="folder"></i> –ê–ª—å–±–æ–º—ã</h3>
                <div id="albums-grid" class="grid-row">
                    <!-- –ê–ª—å–±–æ–º—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
                
                <h3 class="sec-title"><i data-lucide="image"></i> –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∏ —Ñ–∞–π–ª—ã</h3>
                <div id="files-grid" class="grid-cols">
                    <!-- –§–∞–π–ª—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </section>

            <!-- VIEW: CHATS -->
            <section id="v-chats" class="hidden">
                <div class="chat-container">
                    <div class="chat-list">
                        <div class="cl-head">
                            <span>–ß–∞—Ç—ã</span>
                            <button class="btn-xs" onclick="addChat()" title="–ù–æ–≤—ã–π —á–∞—Ç">
                                <i data-lucide="plus"></i>
                            </button>
                        </div>
                        <div id="cl-items">
                            <!-- –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                    </div>
                    <div class="chat-box">
                        <div id="chat-empty">
                            <i data-lucide="message-square" width="48" height="48" style="color:#9CA3AF; margin-bottom:16px;"></i>
                            <p>–í—ã–±–µ—Ä–∏—Ç–µ —á–∞—Ç –¥–ª—è –Ω–∞—á–∞–ª–∞ –æ–±—â–µ–Ω–∏—è</p>
                            <p style="font-size:14px; color:#6B7280; margin-top:10px;">–ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —á–∞—Ç –∫–Ω–æ–ø–∫–æ–π "+"</p>
                        </div>
                        <div id="chat-interface" class="hidden">
                            <!-- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —á–∞—Ç–∞ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- VIEW: PROFILE -->
            <section id="v-profile" class="hidden">
                <div class="profile-header">
                    <div class="p-avatar" id="p-avatar">SK</div>
                    <div class="p-info">
                        <h2 id="p-username">Username</h2>
                        <p id="p-handle">@handle</p>
                        <p id="p-bio" class="bio">Loading...</p>
                    </div>
                    <button class="btn-sec" onclick="openEditProfile()">
                        <i data-lucide="edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                    </button>
                </div>
                
                <div class="stats-row">
                    <div class="stat">
                        <span class="val" id="s-photos">0</span>
                        <span class="lbl">–§–û–¢–û</span>
                    </div>
                    <div class="stat">
                        <span class="val" id="s-albums">0</span>
                        <span class="lbl">–ê–õ–¨–ë–û–ú–´</span>
                    </div>
                    <div class="stat">
                        <span class="val" id="s-friends">0</span>
                        <span class="lbl">–î–†–£–ó–¨–Ø</span>
                    </div>
                    <div class="stat">
                        <span class="val" id="s-chats">0</span>
                        <span class="lbl">–ß–ê–¢–´</span>
                    </div>
                </div>

                <!-- –ó–∞–ø—Ä–æ—Å—ã –≤ –¥—Ä—É–∑—å—è -->
                <div class="friends-sec" id="friend-requests-sec" style="display: none;">
                    <div class="fs-head">
                        <h3><i data-lucide="user-plus"></i> –ó–∞–ø—Ä–æ—Å—ã –≤ –¥—Ä—É–∑—å—è</h3>
                    </div>
                    <div id="friend-requests-list">
                        <!-- –ó–∞–ø—Ä–æ—Å—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>

                <!-- –°–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π -->
                <div class="friends-sec">
                    <div class="fs-head">
                        <h3><i data-lucide="users"></i> –î—Ä—É–∑—å—è</h3>
                        <button class="btn-xs" onclick="addFriend()" title="–î–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∞">
                            <i data-lucide="user-plus"></i>
                        </button>
                    </div>
                    <div id="friends-list">
                        <!-- –î—Ä—É–∑—å—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- FLOATING BUTTONS -->
    <div class="floating-dock">
        <button class="float-btn yellow" onclick="toggleModal('bug-modal')" title="–°–æ–æ–±—â–∏—Ç—å –æ–± –æ—à–∏–±–∫–µ">
            <i data-lucide="alert-triangle"></i>
        </button>
        <button class="float-btn green" onclick="toggleModal('ai-modal')" title="AI –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç">
            <i data-lucide="bot"></i>
        </button>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
    
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å–ª–∏ –º—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
            if (window.location.pathname.startsWith('/recover/')) {
                document.getElementById('app').classList.add('hidden');
                document.getElementById('auth-modal').classList.add('hidden');
                document.getElementById('recovery-page').classList.remove('hidden');
                
                const token = window.location.pathname.split('/')[2];
                if (token) {
                    document.getElementById('recovery-token-input').value = token;
                    setTimeout(() => verifyRecoveryToken(), 500);
                }
            } else {
                // –û–±—ã—á–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
                checkSession();
                initEventListeners();
                
                if (typeof lucide !== 'undefined') {
                    lucide.createIcons();
                }
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —Å—Ç–∞—Ç—É—Å–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
                setTimeout(() => {
                    checkSecurityStatus();
                }, 1000);
            }
        });
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
        function checkEncryptionStatus() {
            const statusElement = document.getElementById('home-encryption-info');
            if (statusElement) {
                statusElement.innerHTML = `
                    <div style="text-align: center; padding: 20px;">
                        <i data-lucide="loader" width="24" height="24" style="animation: spin 1s linear infinite;"></i>
                        <p style="margin-top: 10px;">–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è...</p>
                    </div>
                `;
                checkSecurityStatus();
            }
        }
    </script>
</body>
</html>